# Apple Leaf Disease Classification - Multi-Model Comparison zip removed

A comprehensive deep learning project for automated classification of apple leaf diseases using multiple state-of-the-art CNN architectures. Optimized for resource-constrained hardware (i3 6th gen) with cloud deployment support.

## ğŸ¯ Project Overview

This project implements and compares **4 different deep learning architectures** for apple leaf disease classification:
- **MobileNetV2**: Lightweight and efficient
- **MobileNetV3**: Improved MobileNet with better accuracy
- **ResNet**: Deep residual learning
- **EfficientNet**: Compound scaling for optimal performance

**Target Accuracy**: 95%+ with Test-Time Augmentation (TTA)

## ğŸ“Š Dataset

### Classes (4 categories)
- **Alternaria**: Apple alternaria leaf spot disease
- **Healthy**: Healthy apple leaves
- **Rust**: Apple rust disease
- **Scab**: Apple scab disease

### Dataset Structure
```
apple_dataset/
â”œâ”€â”€ raw/                    # Original images (not included in repo)
â”‚   â”œâ”€â”€ alternaria/
â”‚   â”œâ”€â”€ healthy/
â”‚   â”œâ”€â”€ rust/
â”‚   â””â”€â”€ scab/
â””â”€â”€ augmented/             # Pre-augmented images (generated by script)
    â”œâ”€â”€ alternaria/
    â”œâ”€â”€ healthy/
    â”œâ”€â”€ rust/
    â””â”€â”€ scab/
```

**Note**: Dataset images are not included in this repository. You need to provide your own dataset following the structure above.

## ğŸ—ï¸ Project Structure

```
apple_diseases_classification/
â”œâ”€â”€ mobilenetv2/           # MobileNetV2 model
â”‚   â”œâ”€â”€ train.py          # Optimized training script
â”‚   â”œâ”€â”€ checkpoints/      # Saved models
â”‚   â”œâ”€â”€ logs/            # Training logs (CSV)
â”‚   â”œâ”€â”€ results/         # Evaluation results (JSON)
â”‚   â””â”€â”€ README.md        # Model-specific docs
â”‚
â”œâ”€â”€ mobilenetv3/          # MobileNetV3 model
â”‚   â”œâ”€â”€ train.py
â”‚   â”œâ”€â”€ checkpoints/
â”‚   â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ results/
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ resnet/               # ResNet model
â”‚   â””â”€â”€ (coming soon)
â”‚
â”œâ”€â”€ efficientnet/         # EfficientNet model
â”‚   â””â”€â”€ (coming soon)
â”‚
â”œâ”€â”€ scripts/              # Shared utilities
â”‚   â”œâ”€â”€ augment_config.py    # Augmentation configuration
â”‚   â””â”€â”€ augment_images.py    # Data preprocessing
â”‚
â”œâ”€â”€ real_world_test/      # Real-world testing
â”‚   â”œâ”€â”€ real_world_test.py
â”‚   â””â”€â”€ test_images/
â”‚
â”œâ”€â”€ final_result/         # Model comparison
â”‚   â”œâ”€â”€ compare_all_models.py
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ requirements.txt      # Python dependencies
â”œâ”€â”€ PROJECT_STRUCTURE.md  # Detailed structure
â””â”€â”€ README.md            # This file
```

## ğŸš€ Quick Start

### Prerequisites

```bash
# Python 3.8+
python --version

# Create virtual environment
python -m venv venv
source venv/bin/activate  # Linux/Mac
# or venv\Scripts\activate  # Windows

# Install dependencies
pip install -r requirements.txt
```

### Training a Model

#### Option 1: Train MobileNetV2 (Fastest)
```bash
cd mobilenetv2
python train.py
```

#### Option 2: Train MobileNetV3 (Better Accuracy)
```bash
cd mobilenetv3
python train.py
```

### Pre-Augment Dataset (Optional)
```bash
python scripts/augment_images.py
```
**Note**: Pre-augmentation is optional. Training scripts can work with raw data using runtime augmentation.

## ğŸ’» Training Specifications

### Hardware Requirements
- **Minimum**: Intel i3 6th gen (4GB RAM)
- **Recommended**: GPU (NVIDIA T4 or better)
- **Cloud**: Google Colab (Free T4 GPU)

### Training Hyperparameters

| Parameter | MobileNetV2 | MobileNetV3 |
|-----------|-------------|-------------|
| Image Size | 128Ã—128 | 128Ã—128 |
| Batch Size | 12 | 12 |
| Phase 1 Epochs | 12 | 12 |
| Phase 2 Epochs | 6 | 6 |
| Total Epochs | 18 | 18 |
| Label Smoothing | 0.08 | 0.08 |
| TTA Augmentations | 7 | 7 |
| Mixed Precision | âœ… | âœ… |

### Expected Training Time

| Hardware | Time |
|----------|------|
| i3 6th Gen (CPU) | ~1.5-2 hours |
| Google Colab (T4 GPU) | ~15-30 minutes |
| RTX 3060 (GPU) | ~10-15 minutes |

## ğŸ“ˆ Model Outputs

Each training run generates:
- **Checkpoints**: `checkpoints/best_*.keras` - Best model weights
- **Logs**: `logs/*.csv` - Training history
- **Results**: `results/*.json` - Comprehensive metrics
- **Plots**: 
  - `evaluation_plots_*.png` - Confusion matrix, ROC, PR curves
  - `training_curves_*.png` - Accuracy/loss curves

### Evaluation Metrics
- Accuracy (Standard & TTA)
- Mean Average Precision (MAP)
- Per-class Precision, Recall, F1-Score
- ROC-AUC curves
- Confusion matrices
- Generalization gap

## â˜ï¸ Google Colab Deployment

### Setup Instructions

1. **Push code to GitHub** (dataset excluded)
2. **Upload dataset to Google Drive** or prepare for direct upload
3. **Open Google Colab** and create new notebook
4. **Select GPU runtime**: Runtime â†’ Change runtime type â†’ GPU (T4)

### Colab Setup Code

```python
# Mount Google Drive (if dataset stored there)
from google.colab import drive
drive.mount('/content/drive')

# Clone repository
!git clone https://github.com/YOUR_USERNAME/YOUR_REPO.git
%cd YOUR_REPO

# Install dependencies
!pip install -q tensorflow matplotlib seaborn scikit-learn

# Copy dataset from Drive (adjust path)
!cp -r /content/drive/MyDrive/apple_dataset ./

# Train model
%cd mobilenetv2
!python train.py
```

## ğŸ”§ Configuration

### Augmentation Settings
Edit `scripts/augment_config.py` to customize:
- Rotation range
- Width/height shifts
- Zoom range
- Brightness adjustments
- Custom preprocessing functions

### Training Parameters
Edit model-specific `train.py` to adjust:
- Image size
- Batch size
- Number of epochs
- Learning rate schedules
- Layer unfreezing strategy

## ğŸ“Š Model Comparison

Use `final_result/compare_all_models.py` to compare all trained models:
```bash
cd final_result
python compare_all_models.py
```

Generates comprehensive comparison reports across all architectures.

## ğŸ§ª Real-World Testing

Test your trained models on real-world images:
```bash
cd real_world_test
python real_world_test.py --model ../mobilenetv2/checkpoints/best_*.keras --image test_images/sample.jpg
```

## ğŸ“ Research Paper Ready

This project structure is designed for research papers:
- âœ… Consistent evaluation metrics across models
- âœ… Comprehensive visualizations
- âœ… Reproducible experiments
- âœ… Detailed logging and results

## ğŸ¤ Contributing

Contributions are welcome! Areas for improvement:
- Additional model architectures
- Enhanced augmentation strategies
- Ensemble methods
- Mobile deployment optimization
- Extended disease categories

## ğŸ“„ License

[Add your license here]

## ğŸ”— References

- MobileNetV2: [Sandler et al., 2018](https://arxiv.org/abs/1801.04381)
- MobileNetV3: [Howard et al., 2019](https://arxiv.org/abs/1905.02244)
- ResNet: [He et al., 2015](https://arxiv.org/abs/1512.03385)
- EfficientNet: [Tan & Le, 2019](https://arxiv.org/abs/1905.11946)

## ğŸ“§ Contact

[Add your contact information]

---

**Note**: This is an active research project. Star â­ the repository to follow updates!
